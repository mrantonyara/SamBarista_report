<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SamBarista Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: #f9fafb;
    color: #111827;
    margin: 0;
    padding: 0;
  }
  header {
    background: #f59e0b;
    color: white;
    padding: 1rem 2rem;
    text-align: center;
    font-size: 1.5rem;
    font-weight: bold;
  }
  main {
    max-width: 1200px;
    margin: 2rem auto;
    background: white;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  }
  textarea {
    width: 100%;
    height: 160px;
    font-family: monospace;
    padding: 1rem;
    border-radius: .5rem;
    border: 1px solid #ddd;
    resize: vertical;
  }
  button {
    background: #f59e0b;
    color: white;
    border: none;
    padding: .8rem 1.5rem;
    font-size: 1rem;
    border-radius: .5rem;
    cursor: pointer;
    transition: 0.2s;
  }
  button:hover { background: #d97706; }
  h2 { margin-top: 2rem; }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
  }
  th, td {
    border-bottom: 1px solid #eee;
    text-align: left;
    padding: .5rem;
  }
  th { background: #f3f4f6; }
  .stats {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 1rem;
  }
  .card {
    flex: 1 1 200px;
    background: #fef3c7;
    padding: 1rem;
    border-radius: .75rem;
    text-align: center;
    font-weight: 600;
  }
  canvas { margin-top: 2rem; }
</style>
</head>
<body>

<header>‚òï SamBarista Dashboard</header>

<main>
  <h2>–í—Å—Ç–∞–≤—å –æ—Ç—á—ë—Ç –æ –ø—Ä–æ–¥–∞–∂–∞—Ö</h2>
  <p>–§–æ—Ä–º–∞—Ç: <code>–ù–∞–∑–≤–∞–Ω–∏–µ\t–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ\t–°—É–º–º–∞</code> (–≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã, –∫–∞–∫ —É —Ç–µ–±—è –≤ –ø—Ä–∏–º–µ—Ä–µ)</p>
  <textarea id="inputData" placeholder="–í—Å—Ç–∞–≤—å —Å—é–¥–∞ —Ç–µ–∫—Å—Ç –æ—Ç—á—ë—Ç–∞..."></textarea><br><br>
  <button onclick="analyze()">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>

  <div id="summary"></div>
  <canvas id="salesChart"></canvas>

  <h2>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –Ω–∞–ø–∏—Ç–∫–∞–º</h2>
  <div id="details"></div>
</main>

<script>
const baseProducts = {
  "Choco-Pie": { price: 250, purchase: 130, coffee: 0, milk: 0, chocolate: 0, coconut: 0, water: 0, stick: 1, straw: 0, cup: 1, sleeve: 1, lid: 1, sugar: 0 },
  "Choco-Pie Dark": { price: 250, purchase: 130, cup: 1, sleeve: 1, lid: 1 },
  "Picnic": { price: 450, purchase: 250, cup: 1, sleeve: 1, lid: 1 },
  "Twix": { price: 550, purchase: 300, cup: 1, sleeve: 1, lid: 1 },
  "–ê–º–µ—Ä–∏–∫–∞–Ω–æ 250ml (SamBarista)": { price: 490, purchase: 100, coffee: 1, water: 250, cup: 1, lid: 1, sugar: 1 },
  "–ì–æ—Ä—è—á–∏–π —à–æ–∫–æ–ª–∞–¥ 250ml (SamBarista)": { price: 590, purchase: 180, coffee: 0, milk: 120, chocolate: 30, cup: 1, lid: 1, sugar: 1 },
  "–ì–æ—Ä—è—á–∏–π —à–æ–∫–æ–ª–∞–¥ 350ml (SamBarista)": { price: 690, purchase: 200, milk: 150, chocolate: 40, cup: 1, lid: 1 },
  "–ö–∞–∫–∞–æ 250ml (SamBarista)": { price: 590, purchase: 150, milk: 120, chocolate: 25, cup: 1, lid: 1 },
  "–ö–∞–∫–∞–æ 350ml (SamBarista)": { price: 690, purchase: 170, milk: 150, chocolate: 30, cup: 1, lid: 1 },
  "–ö–∞–ø—É—á–∏–Ω–æ 250ml (SamBarista)": { price: 590, purchase: 180, coffee: 1, milk: 120, cup: 1, lid: 1, sugar: 1 },
  "–ö–∞–ø—É—á–∏–Ω–æ 350ml (SamBarista)": { price: 690, purchase: 200, coffee: 1, milk: 150, cup: 1, lid: 1, sugar: 1 },
  "–ö–æ–∫–æ—Å–æ–≤—ã–π –∫–æ–∫—Ç–µ–π–ª—å 250ml (SamBarista)": { price: 590, purchase: 200, milk: 120, coconut: 30, cup: 1, lid: 1 },
  "–ö–æ–∫–æ—Å–æ–≤—ã–π –∫–æ–∫—Ç–µ–π–ª—å 350ml (SamBarista)": { price: 690, purchase: 220, milk: 150, coconut: 40, cup: 1, lid: 1 },
  "–ö–æ–∫–æ—Å–æ–≤—ã–π —Ä–∞—Ñ 250ml (SamBarista)": { price: 590, purchase: 200, coffee: 1, milk: 120, coconut: 30, cup: 1, lid: 1 },
  "–ö–æ–∫–æ—Å–æ–≤—ã–π —Ä–∞—Ñ 350ml (SamBarista)": { price: 690, purchase: 220, coffee: 1, milk: 150, coconut: 40, cup: 1, lid: 1 },
  "–ö–æ–∫–æ—Å–æ–≤—ã–π —à–æ–∫–æ–ª–∞–¥ 250ml (SamBarista)": { price: 590, purchase: 200, milk: 120, chocolate: 30, coconut: 20, cup: 1, lid: 1 },
  "–ö–æ–∫–æ—Å–æ–≤—ã–π —à–æ–∫–æ–ª–∞–¥ 350ml (SamBarista)": { price: 690, purchase: 220, milk: 150, chocolate: 40, coconut: 25, cup: 1, lid: 1 },
  "–õ–∞—Ç—Ç–µ 250ml (SamBarista)": { price: 590, purchase: 180, coffee: 1, milk: 120, cup: 1, lid: 1, sugar: 1 },
  "–õ–∞—Ç—Ç–µ 350ml (SamBarista)": { price: 690, purchase: 200, coffee: 1, milk: 150, cup: 1, lid: 1, sugar: 1 },
  "–ú–æ–∫–∫–∞—á–∏–Ω–æ 250ml (SamBarista)": { price: 590, purchase: 200, coffee: 1, milk: 120, chocolate: 25, cup: 1, lid: 1 },
  "–ú–æ–∫–∫–∞—á–∏–Ω–æ 350ml (SamBarista)": { price: 690, purchase: 220, coffee: 1, milk: 150, chocolate: 35, cup: 1, lid: 1 },
  "–¢–∞—ë–∂–Ω—ã–π —á–∞–π 350ml (SamBarista)": { price: 500, purchase: 150, water: 350, cup: 1, lid: 1 },
  "–§–ª—ç—Ç –£–∞–π—Ç 250ml (SamBarista)": { price: 590, purchase: 200, coffee: 1, milk: 120, cup: 1, lid: 1 },
  "–§–ª—ç—Ç –£–∞–π—Ç 350ml (SamBarista)": { price: 690, purchase: 220, coffee: 1, milk: 150, cup: 1, lid: 1 },
};

function analyze() {
  const text = document.getElementById('inputData').value.trim();
  if (!text) return alert("–í—Å—Ç–∞–≤—å —Ç–µ–∫—Å—Ç –æ—Ç—á—ë—Ç–∞!");
  
  const lines = text.split(/\n/);
  const results = [];
  let totalSales = 0, totalQty = 0, totalProfit = 0;
  
  lines.forEach(line => {
    const [name, qtyStr, sumStr] = line.split(/\t/);
    const qty = parseInt(qtyStr) || 0;
    const sum = parseFloat(sumStr) || 0;
    const base = baseProducts[name];
    if (!base) return;
    const revenue = sum;
    const cost = base.purchase * qty;
    const profit = revenue - cost;
    results.push({ name, qty, revenue, profit, cost });
    totalSales += revenue;
    totalQty += qty;
    totalProfit += profit;
  });
  
  document.getElementById('summary').innerHTML = `
    <h2>üìä –ò—Ç–æ–≥–∏</h2>
    <div class="stats">
      <div class="card">–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞<br><b>${totalSales.toLocaleString()} ‚Ç∏</b></div>
      <div class="card">–í—Å–µ–≥–æ –ø—Ä–æ–¥–∞–∂<br><b>${totalQty}</b></div>
      <div class="card">–°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂–∏<br><b>${(totalSales / totalQty || 0).toFixed(0)} ‚Ç∏</b></div>
      <div class="card">–ü—Ä–∏–±—ã–ª—å<br><b>${totalProfit.toLocaleString()} ‚Ç∏</b></div>
    </div>
  `;

  // –ì—Ä–∞—Ñ–∏–∫
  const ctx = document.getElementById('salesChart').getContext('2d');
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: results.map(r => r.name),
      datasets: [{ label: '–í—ã—Ä—É—á–∫–∞ (‚Ç∏)', data: results.map(r => r.revenue) }]
    },
    options: { responsive: true, plugins: { legend: { display: false } } }
  });

  // –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è
  let html = `<table><tr><th>–ù–∞–ø–∏—Ç–æ–∫</th><th>–ü—Ä–æ–¥–∞–Ω–æ</th><th>–í—ã—Ä—É—á–∫–∞</th><th>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</th><th>–ü—Ä–∏–±—ã–ª—å</th></tr>`;
  results.forEach(r => {
    html += `<tr>
      <td>${r.name}</td>
      <td>${r.qty}</td>
      <td>${r.revenue.toLocaleString()} ‚Ç∏</td>
      <td>${r.cost.toLocaleString()} ‚Ç∏</td>
      <td>${r.profit.toLocaleString()} ‚Ç∏</td>
    </tr>`;
  });
  html += `</table>`;
  document.getElementById('details').innerHTML = html;
}
</script>

</body>
</html>
